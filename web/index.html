<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orderation - Restaurant Reservation System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1, h2, h3 { margin-bottom: 15px; color: #333; }
        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; }
        .hidden { display: none; }
        form { margin-bottom: 20px; }
        input, textarea, button, select { 
            padding: 8px; margin: 5px; border: 1px solid #ccc; 
            font-size: 14px; 
        }
        button { 
            background: #007bff; color: white; cursor: pointer; 
            border: none; padding: 10px 15px; 
        }
        button:hover { background: #0056b3; }
        button.delete { background: #dc3545; }
        button.delete:hover { background: #c82333; }
        .result { 
            background: #f8f9fa; border: 1px solid #e9ecef; 
            padding: 10px; margin: 10px 0; white-space: pre-wrap; 
            font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;
        }
        .error { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .item { 
            border: 1px solid #eee; padding: 10px; margin: 5px 0; 
            background: #fafafa; 
        }
        .item h4 { margin-bottom: 5px; color: #555; }
        .item p { margin: 2px 0; font-size: 14px; }
        .login-info { 
            background: #e7f3ff; padding: 10px; margin: 10px 0; 
            border-left: 4px solid #007bff; 
        }
        .tab-buttons { margin-bottom: 20px; }
        .tab-button { 
            background: #f8f9fa; color: #333; margin-right: 5px; 
            border: 1px solid #ddd; 
        }
        .tab-button.active { background: #007bff; color: white; }
        .form-row { display: flex; gap: 10px; margin-bottom: 10px; }
        .form-row input, .form-row select { flex: 1; }

    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ½ï¸ Orderation - Restaurant Reservation System</h1>
        
        <!-- Login Status -->
        <div id="loginStatus" class="login-info hidden">
            <strong>å·²ç™»å½•:</strong> <span id="currentUser"></span> (<span id="currentRole"></span>)
            <button onclick="logout()">ç™»å‡º</button>
        </div>

        <!-- Auth Section -->
        <div class="section" id="authSection">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('login')">ç™»å½•</button>
                <button class="tab-button" onclick="showTab('register')">æ³¨å†Œ</button>
            </div>

            <div id="loginTab">
                <h2>ğŸ” ç”¨æˆ·ç™»å½•</h2>
                <form onsubmit="login(event)">
                    <div class="form-row">
                        <input name="email" type="email" placeholder="é‚®ç®±" required>
                        <input name="password" type="password" placeholder="å¯†ç " required>
                        <button type="submit">ç™»å½•</button>
                    </div>
                </form>
            </div>

            <div id="registerTab" class="hidden">
                <h2>ğŸ“ ç”¨æˆ·æ³¨å†Œ</h2>
                <form onsubmit="register(event)">
                    <div class="form-row">
                        <input name="name" placeholder="å§“å" required>
                        <input name="email" type="email" placeholder="é‚®ç®±" required>
                        <input name="password" type="password" placeholder="å¯†ç " required>
                        <button type="submit">æ³¨å†Œ</button>
                    </div>
                </form>
            </div>
            <div class="result" id="authResult"></div>
        </div>

        <!-- Main App (hidden until login) -->
        <div id="mainApp" class="hidden">
            
            <!-- Restaurants Section -->
            <div class="section">
                <h2>ğŸª é¤å…ç®¡ç†</h2>
                
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="showRestaurantTab('list')">æµè§ˆé¤å…</button>
                    <button class="tab-button" id="createRestaurantTab" onclick="showRestaurantTab('create')" style="display:none;">åˆ›å»ºé¤å…</button>
                </div>

                <div id="restaurantListTab">
                    <button onclick="loadRestaurants()">ğŸ”„ åˆ·æ–°é¤å…åˆ—è¡¨</button>
                    <div id="restaurantsList"></div>
                </div>

                <div id="restaurantCreateTab" class="hidden">
                    <h3>åˆ›å»ºæ–°é¤å…</h3>
                    <form onsubmit="createRestaurant(event)">
                        <div class="form-row">
                            <input name="name" placeholder="é¤å…åç§°" required>
                            <input name="address" placeholder="é¤å…åœ°å€" required>
                        </div>
                        <div class="form-row">
                            <input name="openTime" placeholder="è¥ä¸šå¼€å§‹æ—¶é—´ (ä¾‹: 09:00)" required>
                            <input name="closeTime" placeholder="è¥ä¸šç»“æŸæ—¶é—´ (ä¾‹: 22:00)" required>
                            <button type="submit">åˆ›å»ºé¤å…</button>
                        </div>
                    </form>
                </div>
                <div class="result" id="restaurantResult"></div>
            </div>

            <!-- Tables Section -->
            <div class="section">
                <h2>ğŸª‘ æ¡Œå°ç®¡ç†</h2>
                <div class="form-row">
                    <input id="tableRestaurantId" placeholder="é¤å…ID" required>
                    <button onclick="loadTables()">ğŸ“‹ æŸ¥çœ‹æ¡Œå°</button>
                    <button id="createTableBtn" onclick="showCreateTable()" style="display:none;">â• æ·»åŠ æ¡Œå°</button>
                </div>

                <div id="createTableForm" class="hidden">
                    <h3>æ·»åŠ æ–°æ¡Œå°</h3>
                    <form onsubmit="createTable(event)">
                        <div class="form-row">
                            <input name="name" placeholder="æ¡Œå°åç§° (ä¾‹: A1)" required>
                            <input name="capacity" type="number" placeholder="åº§ä½æ•°" min="1" required>
                            <button type="submit">åˆ›å»ºæ¡Œå°</button>
                        </div>
                    </form>
                </div>

                <div id="tablesList"></div>
                <div class="result" id="tablesResult"></div>
            </div>

            <!-- Availability Check -->
            <div class="section" id="availabilitySection">
                <h2>ğŸ” æŸ¥çœ‹å¯ç”¨æ€§</h2>
                <form onsubmit="checkAvailability(event)">
                    <div class="form-row">
                        <input name="restaurantId" placeholder="é¤å…ID" required>
                        <input name="startTime" type="datetime-local" required>
                        <input name="endTime" type="datetime-local" required>
                    </div>
                    <div class="form-row">
                        <input name="guests" type="number" placeholder="å°±é¤äººæ•°" min="1" required>
                        <button type="submit">ğŸ” æŸ¥çœ‹å¯ç”¨æ¡Œå°</button>
                    </div>
                </form>
                <div id="availabilityList"></div>
                <div class="result" id="availabilityResult"></div>
            </div>

            <!-- Reservations Section -->
            <div class="section">
                <h2>ğŸ“… é¢„è®¢ç®¡ç†</h2>
                
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="showReservationTab('create')">åˆ›å»ºé¢„è®¢</button>
                    <button class="tab-button" onclick="showReservationTab('mine')">æˆ‘çš„é¢„è®¢</button>
                </div>

                <div id="reservationCreateTab">
                    <h3>åˆ›å»ºæ–°é¢„è®¢</h3>
                    <form onsubmit="createReservation(event)">
                        <div class="form-row">
                            <input name="restaurantId" placeholder="é¤å…ID" required>
                            <input name="tableId" placeholder="æ¡Œå°ID (å¯é€‰)">
                        </div>
                        <div class="form-row">
                            <input name="startTime" type="datetime-local" required>
                            <input name="endTime" type="datetime-local" required>
                            <input name="guests" type="number" placeholder="å°±é¤äººæ•°" min="1" required>
                        </div>
                        <button type="submit">ğŸ“ åˆ›å»ºé¢„è®¢</button>
                    </form>
                </div>

                <div id="reservationMineTab" class="hidden">
                    <button onclick="loadMyReservations()">ğŸ”„ åˆ·æ–°æˆ‘çš„é¢„è®¢</button>
                    <div id="myReservationsList"></div>
                </div>

                <div class="result" id="reservationResult"></div>
            </div>

        </div>

        <!-- Global Results -->
        <div class="result" id="globalResult"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>